---
import SocialIcons from "../ui/SocialIcons.astro";
import { defaultLang, useTranslations, type Lang } from "../../i18n/index";
import { getLocalizedPath } from "../../i18n/utils";

interface Props {
    title?: string;
    subtitle?: string;
    lang?: Lang;
}

const { lang = defaultLang } = Astro.props;
const t = useTranslations(lang);

const title = Astro.props.title || t("cta.title");
const subtitle = Astro.props.subtitle || t("cta.subtitle");
---

<section
    class="relative py-24 md:py-32 px-6 md:px-8 overflow-hidden"
    data-reveal
>
    <div class="max-w-4xl mx-auto text-center">
        <!-- Subtle Decorative Element -->
        <div
            class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[600px] h-[600px] rounded-full blur-3xl"
            style="background: radial-gradient(circle, rgba(6, 182, 212, 0.1) 0%, transparent 70%);"
        >
        </div>

        <div class="relative z-10">
            <!-- Label -->
            <span
                class="inline-block text-xs font-bold uppercase tracking-wider text-accent mb-4"
            >
                {t("cta.label")}
            </span>

            <!-- Title -->
            <h2
                class="font-display font-bold text-3xl md:text-4xl lg:text-5xl text-neutral-900 dark:text-white mb-6"
            >
                {title}
            </h2>

            <!-- Subtitle -->
            <p
                class="text-lg text-neutral-600 dark:text-neutral-400 max-w-2xl mx-auto mb-10"
            >
                {subtitle}
            </p>

            <!-- CTAs -->
            <div class="flex flex-col sm:flex-row gap-4 justify-center">
                <button
                    type="button"
                    class="cta-email-btn inline-flex items-center justify-center gap-2 px-6 py-3 bg-accent text-white rounded-full font-medium hover:bg-accent-600 transition-colors text-lg"
                    data-user="jonas"
                    data-domain="wilinski.me"
                >
                    <svg
                        class="w-5 h-5"
                        fill="none"
                        stroke="currentColor"
                        viewBox="0 0 24 24"
                    >
                        <path
                            stroke-linecap="round"
                            stroke-linejoin="round"
                            stroke-width="2"
                            d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"
                        ></path>
                    </svg>
                    {t("cta.sendEmail")}
                </button>
                <a
                    href={getLocalizedPath("/contact", lang)}
                    class="inline-flex items-center justify-center gap-2 px-6 py-3 bg-transparent text-neutral-900 dark:text-white border-2 border-neutral-300 dark:border-neutral-700 rounded-full font-medium hover:border-accent hover:text-accent transition-colors text-lg"
                >
                    {t("cta.moreOptions")}
                </a>
            </div>

            <!-- Social Links -->
            <div class="mt-12">
                <SocialIcons variant="inline" size="w-6 h-6" gap="gap-6" class="justify-center" />
            </div>
        </div>
    </div>
</section>

<script>
    function initCTAEmail() {
        document.querySelectorAll(".cta-email-btn").forEach((el) => {
            const element = el as HTMLButtonElement;
            const user = element.dataset.user;
            const domain = element.dataset.domain;
            if (user && domain) {
                element.addEventListener("click", () => {
                    window.location.href = `mailto:${user}@${domain}`;
                });
            }
        });
    }

    initCTAEmail();
    document.addEventListener("astro:page-load", initCTAEmail);
</script>
